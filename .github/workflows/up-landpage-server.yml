name: Deploy LandPage-HotelVitoria to Server via Tailscale VPN

on:
  push:
    branches:
      - main

jobs:
  deploy:

    runs-on: ubuntu-latest

    steps:

    - name: Tailscale
      id: tailscale
      uses: tailscale/github-action@v2
      with:
        authkey: ${{ secrets.TS_AUTH_KEY }}
        tags: tag:ci

    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Debug Network
      run: |
        echo "Checking DNS resolution for hotel.tail12da2.ts.net"
        nslookup hotel.tail12da2.ts.net
        echo "Pinging hotel.tail12da2.ts.net"
        ping -c 4 hotel.tail12da2.ts.net

    - name: copy file via ssh password
      uses: appleboy/scp-action@v0.1.7
      needs: tailscale
      with:
        host: "hotel.tail12da2.ts.net"
        username: "henrique"
        password: ${{ secrets.SSH_PASSWORD }}
        source: "./*"
        target: "/home/henrique/web-henrique/LpHotel"

    # - name: SSH commands
    #   uses: appleboy/ssh-action@v1.0.3
    #   needs: tailscale
    #   with:
    #     host: ${{ secrets.SSH_HOST }}
    #     username: ${{ secrets.SSH_USERNAME }}
    #     password: ${{ secrets.SSH_PASSWORD }}
    #     script: |
    #       echo "Connected to server"
    #       cd /home/henrique/LpHotel
    #       npm install
    #       npm run build

    #       # Adicione outros comandos conforme necess√°rio
